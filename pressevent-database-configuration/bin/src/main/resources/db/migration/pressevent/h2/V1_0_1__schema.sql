CREATE USER IF NOT EXISTS sa SALT '34055c58f8b3bf4e' HASH '0348848db607afce9c29352fda3c4b8c4f657c54dd6447bc30856ebe5f2cb95f' ADMIN;

CREATE SEQUENCE SAVED_SEARCH_SEQUENCE START WITH 0 BELONGS_TO_TABLE;
CREATE SEQUENCE PROFILE_SEQUENCE START WITH 3 BELONGS_TO_TABLE;
CREATE SEQUENCE PERMISSION_SEQUENCE START WITH 23 BELONGS_TO_TABLE;
CREATE SEQUENCE USER_SEQUENCE START WITH 5 BELONGS_TO_TABLE;;

CREATE MEMORY TABLE SAVED_SEARCH( 
    ID INTEGER DEFAULT (NEXT VALUE FOR SAVED_SEARCH_SEQUENCE) NOT NULL NULL_TO_DEFAULT SEQUENCE SAVED_SEARCH_SEQUENCE, 
    FORM_CLASSNAME VARCHAR(256) NOT NULL, 
    FORM_CONTENT BLOB(10000000), 
    NAME VARCHAR(128) NOT NULL, 
    USER_ID BIGINT 
);

ALTER TABLE SAVED_SEARCH ADD CONSTRAINT CONSTRAINT_1 PRIMARY KEY(ID);

CREATE MEMORY TABLE PROFILE( 
    PROFILE_ID BIGINT DEFAULT (NEXT VALUE FOR PROFILE_SEQUENCE) NOT NULL NULL_TO_DEFAULT SEQUENCE PROFILE_SEQUENCE, 
    CREATED_BY VARCHAR(50) NOT NULL, 
    CREATED_DATE TIMESTAMP NOT NULL, 
    LAST_MODIFIED_BY VARCHAR(50), 
    LAST_MODIFIED_DATE TIMESTAMP, 
    CODEMETIER VARCHAR(255) NOT NULL, 
    DESCRIPTION VARCHAR(256) 
);
ALTER TABLE PROFILE ADD CONSTRAINT CONSTRAINT_18 PRIMARY KEY(PROFILE_ID);

CREATE MEMORY TABLE PERMISSION( 
    PERMISSION_ID BIGINT DEFAULT (NEXT VALUE FOR PERMISSION_SEQUENCE) NOT NULL NULL_TO_DEFAULT SEQUENCE PERMISSION_SEQUENCE, 
    CREATED_BY VARCHAR(50) NOT NULL, 
    CREATED_DATE TIMESTAMP NOT NULL, 
    LAST_MODIFIED_BY VARCHAR(50), 
    LAST_MODIFIED_DATE TIMESTAMP, 
    DESCRIPTION VARCHAR(256), 
    ENTITY VARCHAR(255) NOT NULL, 
    ROLE VARCHAR(255) NOT NULL 
);
ALTER TABLE PERMISSION ADD CONSTRAINT CONSTRAINT_F PRIMARY KEY(PERMISSION_ID);

CREATE MEMORY TABLE PROFILE_PERMISSION( 
    PROFILE_ID BIGINT NOT NULL, 
    PERMISSION_ID BIGINT NOT NULL 
);

CREATE MEMORY TABLE USER( 
    ID BIGINT DEFAULT (NEXT VALUE FOR USER_SEQUENCE) NOT NULL NULL_TO_DEFAULT SEQUENCE USER_SEQUENCE, 
    CREATED_BY VARCHAR(50) NOT NULL, 
    CREATED_DATE TIMESTAMP NOT NULL, 
    LAST_MODIFIED_BY VARCHAR(50), 
    LAST_MODIFIED_DATE TIMESTAMP, 
    LOGIN VARCHAR(50) NOT NULL, 
    PASSWORD VARCHAR(64) NOT NULL, 
);
ALTER TABLE USER ADD CONSTRAINT CONSTRAINT_2 PRIMARY KEY(ID);

CREATE MEMORY TABLE USER_PROFILE( 
    PROFILE_ID BIGINT NOT NULL, 
    USER_ID BIGINT NOT NULL 
);

ALTER TABLE PROFILE ADD CONSTRAINT UK_7OQ8NH8LD53YBPO3N77XA1F7I UNIQUE(CODEMETIER);
ALTER TABLE PROFILE_PERMISSION ADD CONSTRAINT UK7CVQP27YGDEL75YDMB2I88N6K UNIQUE(PROFILE_ID, PERMISSION_ID);
ALTER TABLE USER_PROFILE ADD CONSTRAINT UKUserProfile UNIQUE(USER_ID, PROFILE_ID);
ALTER TABLE PROFILE_PERMISSION ADD CONSTRAINT FK2PKYAKWVUNHWXRE1QT9SVCU2P FOREIGN KEY(PROFILE_ID) REFERENCES PROFILE(PROFILE_ID) NOCHECK;
ALTER TABLE USER_PROFILE ADD CONSTRAINT FKProfile FOREIGN KEY(PROFILE_ID) REFERENCES PROFILE(PROFILE_ID) NOCHECK;
ALTER TABLE USER_PROFILE ADD CONSTRAINT FKUser FOREIGN KEY(USER_ID) REFERENCES USER(ID) NOCHECK;
ALTER TABLE PROFILE_PERMISSION ADD CONSTRAINT FKAWHOQRIXCE51MTAY8Q41KS6D7 FOREIGN KEY(PERMISSION_ID) REFERENCES PERMISSION(PERMISSION_ID) NOCHECK;
ALTER TABLE SAVED_SEARCH ADD CONSTRAINT FKQPOVF3N7QI4FQUWY4L8UTHGY8 FOREIGN KEY(USER_ID) REFERENCES USER(ID) NOCHECK;